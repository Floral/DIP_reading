# 第4章 频率域滤波



## 4.1 背景

使用`mxn`大小的元素的核对大小为`MxN`的图像进行滤波时，需要的运算次数为`MNmn`（乘法和加法）。

如果核是可分离的，那么运算次数可减少为 `MN(m +n)`。我们会发现在频率域中执行等效滤波所需要的运算次数仅为 `2MNlog_2(MN)`，前面的系数 2 表示我们要计算一次正 FFT 和一次反 FFT。

考虑大小为`MxM`和`mxm`的方形图像与核，与不可分离的核相比，FFT的计算优势（空间域计算次数比频率域计算次数）为：

$$C_n(m)=\frac{M^2m^2}{2M^2log_2M^2}=\frac{m^2}{4log_2M}$$

如果是可分离的，那么上式变为：

$$C_n(m)=\frac{2M^2m}{2M^2log_2M^2}=\frac{m}{2log_2M}$$

两种情况下,当C(m)>1时，FFT方法的计算优势更大(根据计算次数)，而当C(m)<1时，空间滤波的优势更大。



![image-20230414171310770](4.1-4.2/image-20230414171310770.png)





## 4.2 基本概念

复数定义：`C=R+jI` 



欧拉公式：$e^{j\theta}=cos\theta+jsin\theta$



冲激函数的取样性质

[第四章 频率域滤波-（二）基本概念之冲激及其取样特性 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/86616714)

冲激串的傅里叶变换还是冲激串，不过频域的周期是时域周期的倒数。

> 时域相乘，频域卷积
>
> 时域卷积，频域相乘



## 4.3 取样和取样函数的傅里叶变换

取样（采样）就是时域乘以冲激串，对应到频率就是卷积一个冲激串。

频域重复的周期是时域冲激串周期（$\Delta T$）的倒数（$1/\Delta T$）。

奈奎斯特频率：信号中最高频率的两倍的频率。

> 有时，**完全以奈奎斯特频率**进行采样足以复原函数，但有时会存在问题！如例4.3所示。



#### 4.3.4 混叠



一种情况就是取样频率小于奈奎斯特频率导致的混叠

第二种情况是对无限时间信号进行限制时间的时候，会引入无限频率分量。（类似于时域上的盒式截取函数，频域上对应一个无限频率的函数，要卷积，所以会引入无限频率分量）

有限持续时间的函数不可能是带限的。反之，带限函数一定会从-∞扩展到∞（除了这个函数是带限且周期的时候，并且截断的结果是完整的整数个周期）。



为了减小混叠效应的影响，有一个操作称为“**反混叠（Anti-Aliasing）**”，就是在采样之前，对原信号进行低通滤波，且滤波的截止频率要小于等于1/2的奈奎斯特频率。一个应用就是数字录音设备里都i有专门的低通滤波器来消除设备所用采样率一半以上的频率分量。



#### 4.3.5 取样后的数据重建函数

通过频率域的理想低通滤波器，然后经过反傅里叶变换，就能得到完美的原函数。这相当于在时域卷积了`sinc`函数。这需要无限项来还原完美的原函数。所以在实际情况中，用的不是这种方法，常用的有：最近邻内插、双线性内插、双三次内插。





